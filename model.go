package malwarebazaar

// QueryStatus returned from the API
type QueryStatus string

// QueryStatuses
const (
	QueryStatusOK QueryStatus = "ok"
)

// APIResponse is a response from a get_info API call
type APIResponse struct {
	QueryStatus QueryStatus `json:"query_status"`
	Entries     []Entry     `json:"data"`
}

// Entry is an entry in the malbazaar database from the api response
type Entry struct {
	Sha256Hash      string       `json:"sha256_hash"`
	Sha1Hash        string       `json:"sha1_hash"`
	Md5Hash         string       `json:"md5_hash"`
	FirstSeen       string       `json:"first_seen"`
	LastSeen        interface{}  `json:"last_seen"`
	FileName        string       `json:"file_name"`
	FileSize        int64        `json:"file_size"`
	FileTypeMIME    string       `json:"file_type_mime"`
	FileType        string       `json:"file_type"`
	Reporter        string       `json:"reporter"`
	Anonymous       int64        `json:"anonymous"`
	Signature       string       `json:"signature"`
	Imphash         string       `json:"imphash"`
	Tlsh            string       `json:"tlsh"`
	Ssdeep          string       `json:"ssdeep"`
	Comment         interface{}  `json:"comment"`
	Tags            []string     `json:"tags"`
	DeliveryMethod  interface{}  `json:"delivery_method"`
	Intelligence    Intelligence `json:"intelligence"`
	FileInformation interface{}  `json:"file_information"`
	YaraRules       []YaraRule   `json:"yara_rules"`
	Comments        interface{}  `json:"comments"`
}

// Intelligence is information about the malware from clamav and other stats
type Intelligence struct {
	Clamav    []string    `json:"clamav"`
	Downloads string      `json:"downloads"`
	Uploads   string      `json:"uploads"`
	Mail      interface{} `json:"mail"`
}

// YaraRule YaraRule
type YaraRule struct {
	RuleName    string  `json:"rule_name"`
	Author      string  `json:"author"`
	Description *string `json:"description"`
	Reference   *string `json:"reference"`
}

// upload is the struct used to pass metadata to the upload endpoint
type upload struct {
	Anonymous      int      `json:"anonymous"`
	DeliveryMethod string   `json:"delivery_method"`
	Tags           []string `json:"tags"`
}
